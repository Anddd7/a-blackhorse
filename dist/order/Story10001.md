### Table of Content
- [In Scope](#in-scope)
- [Out of Scope](#out-of-scope)
- [AC 1](#ac-1)
  - [Flow 1-1 render empty shopping cart](#flow-1-1-render-empty-shopping-cart)
  - [Flow 1-2 call bff api](#flow-1-2-call-bff-api)
  - [Flow 1-3 call service to get dto](#flow-1-3-call-service-to-get-dto)
  - [Flow 1-4 call feign client to get dto](#flow-1-4-call-feign-client-to-get-dto)
  - [Flow 1-5 call backend to get dto](#flow-1-5-call-backend-to-get-dto)
  - [Flow 1-6 call usecase](#flow-1-6-call-usecase)
  - [Flow 1-7 call domain service](#flow-1-7-call-domain-service)
  - [Flow 1-8 call repository](#flow-1-8-call-repository)
  - [Flow 1-9 implement repository and inject the implementation](#flow-1-9-implement-repository-and-inject-the-implementation)
  - [Flow 1-10 verify the sql](#flow-1-10-verify-the-sql)
- [AC 2](#ac-2)
  - [Flow 2-1 render shopping cart](#flow-2-1-render-shopping-cart)
  - [Flow 2-2 call bff api](#flow-2-2-call-bff-api)
  - [Flow 2-3 call service](#flow-2-3-call-service)
  - [Flow 2-4 call feign client](#flow-2-4-call-feign-client)
  - [Flow 2-5 call backend api](#flow-2-5-call-backend-api)
  - [Flow 2-6 call usecase](#flow-2-6-call-usecase)
  - [Flow 2-7 call domain service](#flow-2-7-call-domain-service)
  - [Flow 2-8 call domain repo](#flow-2-8-call-domain-repo)
  - [Flow 2-9 call dao and client to collect data](#flow-2-9-call-dao-and-client-to-collect-data)
  - [Flow 2-10 call db](#flow-2-10-call-db)
  - [Flow 2-11 call api](#flow-2-11-call-api)
- [AC 3](#ac-3)
  - [Flow 3-1 nested calls](#flow-3-1-nested-calls)
- [API Schema](#api-schema)
- [Project Process Definition](#project-process-definition)
# Get the shopping cart info
### In Scope
get current shopping cart from backend and display shopping cart info: price, amount for each product, total of the products
### Out of Scope
- product info is getting from the external system
### AC 1
when i am a customer, 
i can see a message saying 'Your shopping cart is empty' when i haven't add any products, 
so that i can add more products
#### Example
William is reviewing his shopping cart without adding any product
#### Mockup
----
![ac1](https://preview.redd.it/h73wnfhvk3l61.png?width=575&format=png&auto=webp&s=a43c711e25606d31d80ccc5bbdf4b42111abce2c)
#### Flow 1-1 render empty shopping cart
- **Complexity**: MEDIUM - about **60** minutes
##### Processes
- **Process 1-1 | Web.UiComponent**
  add 'ShoppingCart' page
  add 'shopping cart' icon in menu which can redirect user to 'Shopping Cart' page
  click 'shopping cart' and entering the 'Shopping Cart' page
  
  ```typescript
  interface ShoppingCartProps {
      items: ProductDto[]
  }
  ```
  Return expected result
----
- **Process 1-2 | Web.UiComponent -> Mock<Web.AxiosClient>**
  call the api
  **Web.UiComponent -> Mock<Web.AxiosClient>**
  return empty object
----
- **Process 1-1 | Web.UiComponent**
  display message 'Your shopping cart is empty!'
  Return expected result
----
##### Sequence Diagram
> ![c352ea25-eddc-45b1-ad91-ca0b8469f45e](temp/story10001/c352ea25-eddc-45b1-ad91-ca0b8469f45e.png)
#### Flow 1-2 call bff api
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 1-3 | Web.AxiosClient -> Fake<Bff.Controller>**
  \> GET /shoppingCart
  **Web.AxiosClient -> Fake<Bff.Controller>**
  < 404 NOT_FOUND
----
##### Sequence Diagram
> ![d2d8beec-c59d-4c02-ad37-11e7af79674e](temp/story10001/d2d8beec-c59d-4c02-ad37-11e7af79674e.png)
#### Flow 1-3 call service to get dto
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 2-1 | Bff.Controller -> Mock<Bff.Service>**
  retrieve user id from authentication header
  **Bff.Controller -> Mock<Bff.Service>**
  throw not found exception and respond with 404
----
##### Sequence Diagram
> ![0c6473a4-f79a-4002-b618-10111895d5a3](temp/story10001/0c6473a4-f79a-4002-b618-10111895d5a3.png)
#### Flow 1-4 call feign client to get dto
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 2-2 | Bff.Service -> Mock<Bff.FeignClient>**
  call feign client with user id
  **Bff.Service -> Mock<Bff.FeignClient>**
  throw not found exception
----
##### Sequence Diagram
> ![925d525c-bdfb-43ff-858e-2cde92de222c](temp/story10001/925d525c-bdfb-43ff-858e-2cde92de222c.png)
#### Flow 1-5 call backend to get dto
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Inner Logic | Bff.FeignClient**
  \> GET /shoppingCart
  < 404 NOT_FOUND
----
##### Sequence Diagram
> ![6ec008b6-729d-487f-9444-97cf797328d0](temp/story10001/6ec008b6-729d-487f-9444-97cf797328d0.png)
#### Flow 1-6 call usecase
- **Complexity**: MEDIUM - about **60** minutes
##### Processes
- **Process 3-1 | Backend.Controller -> Mock<Backend.Usecase>**
  call usecase to find the shopping cart by user id
  **Backend.Controller -> Mock<Backend.Usecase>**
  throw not found exception and respond with 404
----
##### Sequence Diagram
> ![c881b429-b12b-4a81-b751-a64c4d94b3da](temp/story10001/c881b429-b12b-4a81-b751-a64c4d94b3da.png)
#### Flow 1-7 call domain service
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-2 | Backend.Usecase -> Mock<Backend.DomainService>**
  Collect request parameters
  **Backend.Usecase -> Mock<Backend.DomainService>**
  Return expected result
----
##### Sequence Diagram
> ![e6b50a6a-b4c0-4390-af25-b5db3b173c14](temp/story10001/e6b50a6a-b4c0-4390-af25-b5db3b173c14.png)
#### Flow 1-8 call repository
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-3 | Backend.DomainService -> Mock<Backend.DomainRepository>**
  Collect request parameters
  **Backend.DomainService -> Mock<Backend.DomainRepository>**
  Return expected result
----
##### Sequence Diagram
> ![262e22b5-153b-428b-bd23-b858be6af228](temp/story10001/262e22b5-153b-428b-bd23-b858be6af228.png)
#### Flow 1-9 implement repository and inject the implementation
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-6 | Backend.RepositoryImpl -> Mock<Backend.JpaDao>**
  implement domain repository and search shopping cart in db
  **Backend.RepositoryImpl -> Mock<Backend.JpaDao>**
  returns null
----
##### Sequence Diagram
> ![20256cfa-86a4-4ecb-94eb-7ffec3d7a546](temp/story10001/20256cfa-86a4-4ecb-94eb-7ffec3d7a546.png)
#### Flow 1-10 verify the sql
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-7 | Backend.JpaDao -> Mock<Backend.Postgres>**
  Collect request parameters
  **Backend.JpaDao -> Mock<Backend.Postgres>**
  Return expected result
----
##### Sequence Diagram
> ![65a74d67-39f0-4276-bdbd-df3cf7ff3593](temp/story10001/65a74d67-39f0-4276-bdbd-df3cf7ff3593.png)
### AC 2
when i am a customer,
i can see my shopping cart with the products that i added before,
so that i can review the amount and total price of them
#### Example
William is reviewing his shopping cart after added some products
#### Mockup
----
![ac1](https://preview.redd.it/h73wnfhvk3l61.png?width=575&format=png&auto=webp&s=a43c711e25606d31d80ccc5bbdf4b42111abce2c)
#### Flow 2-1 render shopping cart
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 1-2 | Web.UiComponent -> Mock<Web.AxiosClient>**
  click 'the shopping cart' icon
  **Web.UiComponent -> Mock<Web.AxiosClient>**
  receive response with shopping cart info
  display the product list and the total price
----
##### Sequence Diagram
> ![dbbc7bb4-6fb8-40b9-b03f-6359ac32d46f](temp/story10001/dbbc7bb4-6fb8-40b9-b03f-6359ac32d46f.png)
#### Flow 2-2 call bff api
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 1-3 | Web.AxiosClient -> Fake<Bff.Controller>**
  \> GET /shoppingCart
  Web.AxiosClient -> Fake<Bff.Controller>
  < 200 OK
----
##### Sequence Diagram
> ![cd8a873c-7239-4259-97a3-90f60758317b](temp/story10001/cd8a873c-7239-4259-97a3-90f60758317b.png)
#### Flow 2-3 call service
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 2-1 | Bff.Controller -> Mock<Bff.Service>**
  retrieve user id from authentication header
  **Bff.Controller -> Mock<Bff.Service>**
  Return expected result
----
##### Sequence Diagram
> ![02be1570-ab75-4cb3-b267-a76146fb51cc](temp/story10001/02be1570-ab75-4cb3-b267-a76146fb51cc.png)
#### Flow 2-4 call feign client
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 2-2 | Bff.Service -> Mock<Bff.FeignClient>**
  Collect request parameters
  **Bff.Service -> Mock<Bff.FeignClient>**
  Return expected result
----
##### Sequence Diagram
> ![1f8a3547-1eac-42ea-95b9-8a26cf5a7442](temp/story10001/1f8a3547-1eac-42ea-95b9-8a26cf5a7442.png)
#### Flow 2-5 call backend api
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Inner Logic | Bff.FeignClient**
  \> GET /shoppingCart
  < 200 OK
----
##### Sequence Diagram
> ![a11e9bb4-5283-4141-8bab-4d44cf6bf586](temp/story10001/a11e9bb4-5283-4141-8bab-4d44cf6bf586.png)
#### Flow 2-6 call usecase
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-1 | Backend.Controller -> Mock<Backend.Usecase>**
  call usecase to find the shopping cart by user id
  **Backend.Controller -> Mock<Backend.Usecase>**
  Return expected result
----
##### Sequence Diagram
> ![48b25053-364b-44e7-82a7-182447cb55e7](temp/story10001/48b25053-364b-44e7-82a7-182447cb55e7.png)
#### Flow 2-7 call domain service
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-2 | Backend.Usecase -> Mock<Backend.DomainService>**
  Collect request parameters
  **Backend.Usecase -> Mock<Backend.DomainService>**
  Return expected result
----
##### Sequence Diagram
> ![fae571b8-655e-442f-b08a-b3732f566872](temp/story10001/fae571b8-655e-442f-b08a-b3732f566872.png)
#### Flow 2-8 call domain repo
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-3 | Backend.DomainService -> Mock<Backend.DomainRepository>**
  Collect request parameters
  **Backend.DomainService -> Mock<Backend.DomainRepository>**
  Return expected result
----
##### Sequence Diagram
> ![7e8f32f8-9a7a-4e31-942e-306ed6b95e89](temp/story10001/7e8f32f8-9a7a-4e31-942e-306ed6b95e89.png)
#### Flow 2-9 call dao and client to collect data
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-6 | Backend.RepositoryImpl -> Mock<Backend.JpaDao>**
  
                          implement domain repository and search shopping cart in db
                          get shopping cart with product id
                   
  **Backend.RepositoryImpl -> Mock<Backend.JpaDao>**
  Return expected result
----
- **Process 3-4 | Backend.RepositoryImpl -> Mock<Backend.FeignClient>**
  get product by id
  **Backend.RepositoryImpl -> Mock<Backend.FeignClient>**
  returns shopping cart
----
##### Sequence Diagram
> ![64eed42c-497c-41d0-8d62-25ac13a7d496](temp/story10001/64eed42c-497c-41d0-8d62-25ac13a7d496.png)
#### Flow 2-10 call db
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-7 | Backend.JpaDao -> Mock<Backend.Postgres>**
  use h2
  **Backend.JpaDao -> Mock<Backend.Postgres>**
  Return expected result
----
##### Sequence Diagram
> ![bc5aea6a-86dc-4a8a-b4e3-5e04eadd1469](temp/story10001/bc5aea6a-86dc-4a8a-b4e3-5e04eadd1469.png)
#### Flow 2-11 call api
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 3-5 | Backend.FeignClient -> Mock<Backend.HttpClient>**
  use Wiremock
  **Backend.FeignClient -> Mock<Backend.HttpClient>**
  Return expected result
----
##### Sequence Diagram
> ![7252a182-2bba-4917-a8b8-5c79c2d84161](temp/story10001/7252a182-2bba-4917-a8b8-5c79c2d84161.png)
### AC 3
dsl demo
#### Mockup
----
![ac1](img/google-logo.jpeg)
![ac1](https://www.thehawk.in/hawkcontent/servlet/RDESController?command=rdm.Picture&sessionId=RDWEBD9ZXBMHEVOZY44KG0ZIGGJKEI9YBQY0U&app=rdes&partner=thehawk&type=7&uid=7fqeTRRcJ4ftYOyw41rbQiUSYivnjIvrF5837497)
#### Links
- [Google 1](https://www.google.com)
- [Google 2](https://www.google.com)
#### Flow 3-1 nested calls
- **Complexity**: SMALL - about **30** minutes
##### Processes
- **Process 1-2 | Web.UiComponent -> Mock<Web.AxiosClient>**
  click
  **Web.UiComponent -> Mock<Web.AxiosClient>**
  send request
----
- **Process 1-3 | Web.AxiosClient -> Fake<Bff.Controller>**
  \> GET /go-google
  **Web.AxiosClient -> Fake<Bff.Controller>**
  < 200 OK
----
- **Process 2-1 | Bff.Controller -> Mock<Bff.Service>**
  execute
  **Bff.Controller -> Mock<Bff.Service>**
  Return expected result
----
- **Process 2-2 | Bff.Service -> Mock<Bff.FeignClient>**
  \> GET /go-google
  **Bff.Service -> Mock<Bff.FeignClient>**
  < 200 OK
----
##### Sequence Diagram
> ![4d887473-2636-4684-9c1a-9617c6427b42](temp/story10001/4d887473-2636-4684-9c1a-9617c6427b42.png)
### API Schema
#### Get ShoppingCart
> GET /shoppingCart
- 200 OK
  - Response
  ```json
  {
      products: [{
          id: 10001
          name: "i'm a product",
          amount: 1,
          price: 500.00,
          total: 500.00
      }],
      total: 500.00
  }
  ```
- 404 NOT_FOUND
### Project Process Definition
#### Web
##### Process 1-1 | UiComponent => Real\<UiComponent>
- Just import related ui component, testing with snapshot
##### Process 1-2 | UiComponent => Mock\<AxiosClient>
- Mock axios client
- Call axios client, assert component state
##### Process 1-3 | AxiosClient => Fake\<Bff.Controller>
- Fake api endpoint
- Call fake api, assert the response and error handling is correct
#### Bff
##### Process 2-1 | Controller => Mock\<Service>
- Mock service
- Call service, verify the expected input parameters and assert the expected output return
##### Process 2-2 | Service => Mock\<FeignClient>
- Mock feign client
- Call feign client, verify the expected input parameters and assert the expected output return
#### Backend
##### Process 3-1 | Controller => Mock\<Usecase>
- Mock usecase
- Call usecase, verify the expected input parameters and assert the expected output return
##### Process 3-2 | Usecase => Mock\<DomainService>
- Mock domain service
- Call domain service, verify the expected input parameters and assert the expected output return
##### Process 3-3 | DomainService => Mock\<DomainRepository>
- Mock domain repository
- Call domain repository, verify the expected input parameters and assert the expected output return
##### Process 3-4 | RepositoryImpl => Mock\<FeignClient>
- Mock feign client
- Call feign client, verify the expected input parameters and assert the expected output return
##### Process 3-5 | FeignClient => Mock\<HttpClient>
- Fake http client (using wiremock)
- Call http client, stub the request and response and assert the expected response status and payload
##### Process 3-6 | RepositoryImpl => Mock\<JpaDao>
- Mock jpa dao
- Call jpa dao, verify the expected input parameters and assert the expected output return
##### Process 3-7 | JpaDao => Mock\<Postgres>
- Fake db (using h2 or docker)
- Call fake db, init some test data and assert the execution result set is expected